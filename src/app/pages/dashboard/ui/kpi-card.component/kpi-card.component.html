<article class="kpi-card" [class.kpi-card--active]="kpi.isActive" [class.kpi-card--bars]="!!kpi.miniChart">
  <div class="kpi-card__left">
    <div class="kpi-card__label">{{ kpi.label }}</div>

    <div class="kpi-card__value-row">
      <div class="kpi-card__value">
        {{ kpi.value }}
        <span *ngIf="kpi.unit" class="kpi-card__unit">{{ kpi.unit }}</span>
      </div>

      <span *ngIf="kpi.delta" class="kpi-pill" [class.kpi-pill--good]="kpi.delta.tone === 'success'" [class.kpi-pill--bad]="kpi.delta.tone === 'danger'">
        {{ kpi.delta.text }}
      </span>
    </div>

    <div class="kpi-card__sub" *ngIf="kpi.subline">{{ kpi.subline }}</div>
    <div class="kpi-card__sub" *ngIf="kpi.ring">{{ kpi.ring.targetLabel }}</div>
  </div>

  <div class="kpi-card__right">
    <div class="kpi-icon" [attr.data-icon]="kpi.icon">
      <ng-container [ngSwitch]="kpi.icon">
        <svg *ngSwitchCase="'spark'" width="20" height="20" viewBox="0 0 24 24">
          <path d="M12 2l1.2 4.7L18 8l-4.8 1.3L12 14l-1.2-4.7L6 8l4.8-1.3L12 2Zm7 9 1 3.8L24 16l-4 1.2L19 21l-1-3.8L14 16l4-1.2L19 11Z" fill="currentColor" />
        </svg>

        <svg *ngSwitchCase="'hourglass'" width="20" height="20" viewBox="0 0 24 24">
          <path
            d="M7 2h10v5a5 5 0 0 1-3 4.6V12a5 5 0 0 1 3 4.6V22H7v-5.4A5 5 0 0 1 10 12v-.4A5 5 0 0 1 7 7V2Zm2 2v2.7a3 3 0 0 0 1.5 2.6L12 10l1.5-.7A3 3 0 0 0 15 6.7V4H9Zm6 16v-2.7a3 3 0 0 0-1.5-2.6L12 14l-1.5.7A3 3 0 0 0 9 17.3V20h6Z"
            fill="currentColor"
          />
        </svg>

        <svg *ngSwitchCase="'clock'" width="20" height="20" viewBox="0 0 24 24">
          <path d="M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20Zm1-10.6V7h-2v5.4l4.2 2.6 1-1.7-3.2-1.9Z" fill="currentColor" />
        </svg>

        <svg *ngSwitchCase="'shield'" width="20" height="20" viewBox="0 0 24 24">
          <path d="M12 2 20 6v6c0 5.2-3.4 9.9-8 10-4.6-.1-8-4.8-8-10V6l8-4Zm0 5a1 1 0 0 0-1 1v4.4l-1.6 1.6 1.4 1.4 2-2a1 1 0 0 0 .2-.7V8a1 1 0 0 0-1-1Z" fill="currentColor" />
        </svg>
      </ng-container>
    </div>

    <div class="kpi-ring" *ngIf="kpi.ring">
      <svg width="68" height="68" viewBox="0 0 68 68" aria-hidden="true">
        <circle class="kpi-ring__track" cx="34" cy="34" r="26"></circle>
        <circle class="kpi-ring__value" cx="34" cy="34" r="26" [attr.stroke-dasharray]="ringDash(kpi.ring.value).dash" [attr.stroke-dashoffset]="ringDash(kpi.ring.value).offset"></circle>
      </svg>
    </div>
  </div>

  <div class="kpi-mini-bars" *ngIf="kpi.miniChart">
    <span class="kpi-mini-bar" *ngFor="let bar of kpi.miniChart.bars" [style.height.%]="bar"></span>
  </div>
</article>
